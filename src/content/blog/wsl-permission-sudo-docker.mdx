---
title: WSL 新手除錯全紀錄：權限、sudo 和 Docker 的那些事
description: 從一個 Permission denied 錯誤開始，深入探索 WSL、Ubuntu、Docker 的權限管理機制，分享新手踩坑經驗與解決方案
pubDate: 2025-07-23
updatedDate: 2025-08-06
author: Lin
tags: ['WSL', 'Docker', 'Ubuntu', 'Linux', '權限管理', '除錯經驗']
category: 技術筆記
excerpt: 記錄在 WSL 環境中遇到的權限問題、sudo 使用時機、Docker 權限設定等新手常見問題，以及背後的系統架構原理解析
draft: false
---

## 📝 前言

今天一早，想說來跑一下我的 .NET 專案，結果馬上被一個紅色的錯誤訊息打臉：`Permission denied` (權限不足)。

這個看似簡單的錯誤，最後卻讓我深入了解了整個 WSL + Ubuntu + Docker 的權限體系。這篇文章記錄了我的除錯過程和學到的寶貴經驗。

<br />

---

<br />

## 🔴 一切的開端：一個神秘的 Permission denied

### 問題描述

當我執行 `dotnet build` 時，系統拋出了權限錯誤。看起來是程式在編譯時，想在 `obj` 資料夾裡寫一個暫存檔，但被系統拒絕了。

就像我想在自己的筆記本上寫字，但筆記本卻說：「不，你不是我的主人，不准寫！」

<br />

### 💡 學到的第一課：sudo 的詛咒

經過一番探索，兇手很快就找到了：我之前八成是「貪圖方便」，對專案指令用了 `sudo`。

這就導致專案裡的部分檔案和資料夾，主人變成了至高無上的 `root` 管理員。當我再用我自己的普通使用者帳號去執行 `dotnet build` 時，自然就被當成外人擋在門外。

<br />

**✅ 解決方案：**

```bash
sudo chown -R $USER:$USER .
```

這個指令像個大法官一樣，把所有檔案的擁有權全部「物歸原主」。

<br />

---

<br />

## 🌅 柳暗花明又一村：找不到專案檔

### 新的挑戰

解決了權限問題後，我信心滿滿地再次執行 `dotnet build`，結果... 新的錯誤！

```
Specify a project or solution file
```

好吧，至少這次不是權限問題了。

<br />

### 💡 學到的第二課：你在哪，很重要

原來是我待錯了目錄。`dotnet` 指令就像個搞不清楚狀況的工人，你得先把他帶到正確的工地（包含 `.sln` 或 `.csproj` 檔案的目錄），他才知道要蓋哪一棟房子。

`cd` 進入專案目錄後，一切順利，`Build Succeeded` 的綠色訊息終於出現了！

<br />

---

<br />

## 🐳 深入兔子洞：sudo、Docker 與它們的秘密關係

### 何時該用 sudo？

這次的經驗讓我好奇：那我到底何時才該用 `sudo` 這把「天子之劍」？

<br />

### 💡 學到的第三課：sudo 是手術刀，不是西瓜刀

`sudo` 只用在需要改變「整個系統」的事情上，例如：

- 安裝大家都能用的軟體 (`sudo apt install`)
- 修改系統設定檔 (`/etc` 裡的東西)
- 管理系統服務 (`sudo systemctl start`)

而所有在我家目錄 (`~/`) 裡的事情，都是我自己的事，完全不需要驚動 `sudo` 大駕。

> **最佳實踐：** 先不用 `sudo` 試，如果系統跟你抱怨權限不足，再停下來思考原因。

<br />

### Docker 的特權問題

這時，又引出了 Docker 的特權問題。為什麼 `docker` 指令有時也要 `sudo`？

<br />

### 💡 學到的第四課：Docker 是 C/S 架構的「老闆與員工」

Docker 和 .NET 不一樣。Docker 背後有一個以 `root` 權限運行的超級大老闆 **Daemon (`dockerd`)**。我們平常用的 `docker` 指令只是個傳令兵。為了安全，不是誰都能跟老闆對話。

系統建立了一個 `docker` 群組，就像一張 VIP 名單。只要把我的使用者帳號加入這張名單：

```bash
sudo usermod -aG docker $USER
```

我的傳令兵就能直接和 `root` 老闆溝通，再也不用每次都出示 `sudo` 令牌了。

> **注意：** 執行完上述指令後，需要登出再登入，或執行 `newgrp docker` 讓設定生效。

<br />

---

<br />

## 🎯 終極解密：我的開發環境原來長這樣！

### 環境架構解析

這趟旅程的最後，我才終於搞懂了自己每天在用的環境到底是個什麼樣的「套娃」結構。

<br />

### 💡 學到的第五課：我的高科技商業綜合體

用一句話總結我現在的環境：

> 「我在 **Windows 11** 這片土地上，透過微軟提供的 **WSL 2** 這塊高科技地基，運行著 **Ubuntu** 這個設備齊全的工作室。而 **Docker** 則像個專業承包商，它自備了一個名為 **docker-desktop** 的標準機房，然後巧妙地和我的 Ubuntu 工作室對接，讓我能同時享受 Windows 的便利和 Linux 的強大。」

<br />

### 架構示意圖

```
Windows 11 (主機系統)
    └── WSL 2 (虛擬化層)
        ├── Ubuntu (Linux 發行版)
        │   └── 你的開發專案
        └── Docker Desktop
            └── docker-desktop (專用 VM)
```

所以，當我安裝 Docker Desktop 時，它不是非得裝在我的 Ubuntu 裡，而是聰明地建立了自己的小天地，再跟我合作。

<br />

---

<br />

## 📚 總結與心得

今天從一個小小的權限錯誤開始，一路追查，最後竟然把整個 Windows + WSL + Ubuntu + Docker 的協作體系給摸透了。

### 重點整理

1. **權限問題** - 不要隨便用 `sudo`，除非真的需要系統權限
2. **工作目錄** - 執行指令前確認你在正確的位置
3. **Docker 權限** - 加入 docker 群組避免每次都要 sudo
4. **系統架構** - 理解 WSL、Ubuntu、Docker 的層級關係

### 給新手的建議

- 遇到錯誤不要慌，每個錯誤都是學習的機會
- 理解背後的原理比記住指令更重要
- 建立良好的權限管理習慣，避免未來的麻煩

希望這篇文章能幫助到跟我一樣在 WSL 環境中摸索的新手朋友們！

<br />

---

<br />

*如果你覺得這篇文章對你有幫助，歡迎分享給更多人！有任何問題也歡迎在下方留言討論。*